#!/bin/bash
set -e

export WORKING_DIR=/var/www/podcast-service

echo "=== Move to app dir ==="
cd ${WORKING_DIR}

echo "=== Reading $(pwd)/.env file ==="
export $(cat .env | grep -v "<" | grep -v ^# | xargs)

echo "=== Reading $(pwd)/.version file ==="
export $(cat .version | grep -v ^# | xargs)

echo "=== Starting podcast service ==="
echo "Detected version: '${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}'"
echo "Running service: '$1'..."
docker compose up $1
